#!/bin/sh

# pushpop.test is part of the GNU m4 testsuite

. ${srcdir}/defs

cat ${srcdir}/pushpop.m4 >in

cat <<\EOF >ok
EOF

cat <<\EOF >okerr
hej:	`def 1.'
hej:	`def 2.'
hej:	`def 3.'
hej:	`def 4.'
hej:	`def 3.'
hej:	`def 2.'
hej:	`def 1.'
m4: in: 18: Undefined name hej
m4: in: 20: Undefined name hej
m4: in: 23: Undefined name mac2
m4: in: 25: Undefined name mac2
EOF

M4PATH=$srcdir:$srcdir/../tests $M4 -d in >out 2>err
sed -e "s,^[^:]*[lt-]*m4[.ex]*:,m4:," err >sederr && mv sederr err
$CMP -s out ok && $CMP -s err okerr
