#!/bin/sh

# debug.test is part of the GNU m4 testsuite

. ${srcdir}/defs

cat <<\EOF >in
include(debug.m4)dnl
EOF

cat <<\EOF >ok



2 1 0 Liftoff
EOF

cat <<\EOF >okerr
m4trace: -1- countdown ...
m4trace: -1- countdown(`2') -> ???
m4trace: -1- countdown(...) -> `2 ifelse(eval(2 > 0), 1, `countdown(decr(2))', `Liftoff')'
m4trace: -1- countdown ...
m4trace: -1- countdown(`1') -> ???
m4trace: -1- countdown(...) -> `1 ifelse(eval(1 > 0), 1, `countdown(decr(1))', `Liftoff')'
m4trace: -1- countdown ...
m4trace: -1- countdown(`0') -> ???
m4trace: -1- countdown(...) -> `0 ifelse(eval(0 > 0), 1, `countdown(decr(0))', `Liftoff')'
EOF

M4PATH=$srcdir $M4 -d in >out 2>err
sed -e "s, ../../src/m4:, m4:," err >sederr && mv sederr err

$CMP -s out ok && $CMP -s err okerr
