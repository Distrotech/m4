#!/bin/sh

# pushpop.test is part of the GNU m4 testsuite

. ${srcdir}/defs

cat ${srcdir}/pushpop.m4 >in

cat <<\EOF >ok
EOF

cat <<\EOF >okerr
hej:	`def 1.'
hej:	`def 2.'
hej:	`def 3.'
hej:	`def 4.'
hej:	`def 3.'
hej:	`def 2.'
hej:	`def 1.'
in:18: m4: Undefined name hej
in:20: m4: Undefined name hej
in:23: m4: Undefined name mac2
in:25: m4: Undefined name mac2
EOF

M4PATH=$srcdir:$srcdir/../tests $M4 -d in >out 2>err
sed -e "s, ../../src/m4:, m4:," err >sederr && mv sederr err
$CMP -s out ok && $CMP -s err okerr
